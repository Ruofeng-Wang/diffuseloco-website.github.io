<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <!-- <meta http-equiv="refresh" content="2"> -->
  <link rel="icon" href="assets/favicon.ico" type="image/x-icon">
  <meta name="description" content="DiffuseLoco: Real-Time Legged Locomotion Control with Diffusion from Offline Datasets">
  <meta name="keywords" content="Robotics, Diffusion Policy, Transformer, Reinforcement Learning, Imitation Learning">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DiffuseLoco: Real-Time Legged Locomotion Control with Diffusion from Offline Datasets</title>
  <script src="https://cdn.tailwindcss.com"></script>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
  <!-- and it's easy to individually load additional languages -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/go.min.js"></script>
  <script>hljs.highlightAll();</script>
</head>

<body>
  <div class="bg-gray-100 h-8 md:h-16"></div>

  <div class="container mx-auto px-10">
    <div class="mt-8 md:mt-20 w-full">
      <h1 class="text-3xl md:text-6xl text-left w-full">DiffuseLoco: Real-Time Legged Locomotion Control with Diffusion from Offline Datasets</h1>
      <p class="md:text-2xl mt-8">
        <a class="text-blue-500" href="https://scholar.google.com/citations?user=G-x_szsAAAAJ&hl=en">Xiaoyu Huang</a>,
        <a class="text-blue-500" href="https://chiyufeng.me/">Yufeng Chi</a>,
        <a class="text-blue-500" href="https://www.linkedin.com/in/edison-wang-1097a11ab/">Ruofeng Wang</a>,
        <a class="text-blue-500" href="https://zyliatzju.github.io/">Zhongyu Li</a>,
        <a class="text-blue-500" href="https://xbpeng.github.io/">Xue Bin Peng</a>,
        <a class="text-blue-500" href="https://people.eecs.berkeley.edu/~ysshao/">Sophia Shao</a>,
        <a class="text-blue-500" href="https://www2.eecs.berkeley.edu/Faculty/Homepages/nikolic.html">Borivoje Nikolic</a>,
        <a class="text-blue-500" href="https://hybrid-robotics.berkeley.edu/koushil/">Koushil Sreenath</a>
      </p>
    </div>
    
    <div class="flex flex-row flex-wrap justify-center my-8">
      <a class="flex-initial border rounded-full border-black px-2 py-1 m-1 md:m-10 hover:bg-gray-200" href="./static/berkeley_humanoid.pdf">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="inline size-4 mr-2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z" />
        </svg>Paper
      </a>
      <a class="flex-initial border rounded-full border-black px-2 py-1 m-1 md:m-10 hover:bg-gray-200" href="https://arxiv.org/abs/2404.19264">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="inline size-4 mr-2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M11.35 3.836c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 0 0 .75-.75 2.25 2.25 0 0 0-.1-.664m-5.8 0A2.251 2.251 0 0 1 13.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V8.25m8.9-4.414c.376.023.75.05 1.124.08 1.131.094 1.976 1.057 1.976 2.192V16.5A2.25 2.25 0 0 1 18 18.75h-2.25m-7.5-10.5H4.875c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V18.75m-7.5-10.5h6.375c.621 0 1.125.504 1.125 1.125v9.375m-8.25-3 1.5 1.5 3-3.75" />
        </svg>arXiv
      </a>
      <a class="flex-initial border rounded-full border-black px-2 py-1 m-1 md:m-10 hover:bg-gray-200" href="https://www.youtube.com/watch?v=JAWPT5oWID4">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="inline size-4 mr-2">
          <path stroke-linecap="round" stroke-linejoin="round" d="m15.75 10.5 4.72-4.72a.75.75 0 0 1 1.28.53v11.38a.75.75 0 0 1-1.28.53l-4.72-4.72M4.5 18.75h9a2.25 2.25 0 0 0 2.25-2.25v-9a2.25 2.25 0 0 0-2.25-2.25h-9A2.25 2.25 0 0 0 2.25 7.5v9a2.25 2.25 0 0 0 2.25 2.25Z" />
        </svg>
        Video
      </a>
      <a class="flex-initial border rounded-full border-black px-2 py-1 m-1 md:m-10 hover:bg-gray-200" href="https://arxiv.org/abs/2404.19264">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="inline size-4 mr-2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M17.25 6.75 22.5 12l-5.25 5.25m-10.5 0L1.5 12l5.25-5.25m7.5-3-4.5 16.5" />
        </svg>
        Code Todo
      </a>
    </div>

    <iframe class="w-full aspect-video" src="https://www.youtube.com/embed/JAWPT5oWID4?si=FpP4C6uyUrG8tW-6&start=2&autoplay=1&mute=1" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen autoplay></iframe>

    <h2 class="mt-10 text-3xl md:text-6xl py-10">Abstract</h2>
    <div class="content has-text-justified">
      <p class="md:text-2xl font-light">
        This work introduces <strong>DiffuseLoco</strong>, a framework for training multi-skill diffusion-based policies for dynamic legged locomotion from offline datasets, 
        enabling real-time control of diverse skills on robots in the real world. Offline learning at scale has led to breakthroughs in computer vision, 
        natural language processing, and robotic manipulation domains. However, scaling up learning for legged robot locomotion, especially with multiple 
        skills in a single policy, presents significant challenges for prior online reinforcement learning methods. To address this challenge, 
        we propose a novel, scalable framework that leverages diffusion models to directly learn from offline multimodal datasets with a diverse set of locomotion skills. 
        With design choices tailored for real-time control in dynamical systems, including receding horizon control and delayed inputs, 
        DiffuseLoco is capable of reproducing multimodality in performing various locomotion skills, zero-shot transfer to real quadrupedal robots, 
        and it can be deployed on edge computing devices. Furthermore, DiffuseLoco demonstrates free transitions between skills and robustness against environmental variations. 
        Through extensive benchmarking in real-world experiments, DiffuseLoco exhibits better stability and velocity tracking performance compared to prior reinforcement learning and non-diffusion-based behavior cloning baselines. 
        The design choices are validated via comprehensive ablation studies. This work opens new possibilities for scaling up learning-based legged locomotion controllers through the scaling of large, 
        expressive models and diverse offline datasets.
      </p>
    </div>
  
    <h2 class="mt-10 text-3xl md:text-6xl py-10">Overview</h2>
    <img class="w-full" src="static/workflow-diagram.png"/>

    <h2 class="mt-10 text-3xl md:text-6xl py-10">Multi-modal Locomotion Trained Entirely Offline</h2>
    <div class="flex">
      <div class="basis-1/2">
        <video autoplay loop muted playsinline src="./static/videos/bump.mp4" poster="./static/videos/loading-icon.gif" style="border: 1px solid #bbb; border-radius: 10px; margin: 1.0%;"></video>
      </div>
      <div class="basis-1/2">
        <video autoplay loop muted playsinline src="./static/videos/jump.mp4" poster="./static/videos/loading-icon.gif" style="border: 1px solid #bbb; border-radius: 10px; margin: 1.0%;"></video>
      </div>
      <div class="basis-1/2">
        <video autoplay loop muted playsinline src="./static/videos/pace.mp4" poster="./static/videos/loading-icon.gif" style="border: 1px solid #bbb; border-radius: 10px; margin: 1.0%;"></video>
      </div>
      <div class="basis-1/2">
        <video autoplay loop muted playsinline src="./static/videos/stand.mp4" poster="./static/videos/loading-icon.gif" style="border: 1px solid #bbb; border-radius: 10px; margin: 1.0%;"></video>
      </div>
      <div class="basis-1/2">
        <video autoplay loop muted playsinline src="./static/videos/trot.mp4" poster="./static/videos/loading-icon.gif" style="border: 1px solid #bbb; border-radius: 10px; margin: 1.0%;"></video>
      </div>
    </div>

    <h2 class="mt-10 text-3xl md:text-6xl py-10">Smooth Transitioning</h2>
    <div id="results-carousel" class="carousel results-carousel">
      <div class="item item-steve">
        <div class="column is-full-width is-centered has-text-centered">
          <video poster="./static/videos/loading-icon.gif" autoplay muted loop playsinline height="100%" src="./static/videos/skills_2.mp4"
          style="border-radius: 10px; margin-bottom: 15px; "></video>
          <video poster="./static/videos/loading-icon.gif" autoplay muted loop playsinline height="100%" src="./static/videos/skills_3.mp4"
          style="border-radius: 10px;"></video>
        </div>
      </div>
      <div class="item item-steve">
        <div class="column is-full-width is-centered has-text-centered">
          <video poster="./static/videos/loading-icon.gif" autoplay muted loop playsinline height="100%" src="./static/videos/asphalt.mp4"
          style="border-radius: 10px; margin-bottom: 15px; "></video>
          <video poster="./static/videos/loading-icon.gif" autoplay muted loop playsinline height="100%" src="./static/videos/grass_withered.mp4"
          style="border-radius: 10px;"></video>
        </div>
      </div>
      <div class="item item-blueshirt">
        <div class="column is-full-width is-centered has-text-centered">
          <video poster="./static/videos/loading-icon.gif" autoplay muted loop playsinline height="100%" src="./static/videos/red_brick.mp4"
          style="border-radius: 10px; margin-bottom: 15px; "></video>
          <video poster="./static/videos/loading-icon.gif" autoplay muted loop playsinline height="100%" src="./static/videos/stone_brick.mp4"
          style="border-radius: 10px;"></video>
        </div>
      </div>
      <div class="item item-coffee">
        <div class="column is-full-width is-centered has-text-centered">
          <video poster="./static/videos/loading-icon.gif" autoplay muted loop playsinline height="100%" src="./static/videos/running_track.mp4"
          style="border-radius: 10px; margin-bottom: 15px; "></video>
          <video poster="./static/videos/loading-icon.gif" autoplay muted loop playsinline height="100%" src="./static/videos/bridge_long.mp4"
          style="border-radius: 10px;"></video>
        </div>
      </div>
      <div class="item item-toby">
        <div class="column is-full-width is-centered has-text-centered">
          <video poster="./static/videos/loading-icon.gif" autoplay muted loop playsinline height="100%" src="./static/videos/bridge_short.mp4"
          style="border-radius: 10px; margin-bottom: 15px; "></video>
          <video poster="./static/videos/loading-icon.gif" autoplay muted loop playsinline height="100%" src="./static/videos/indoor.mp4"
          style="border-radius: 10px;"></video>
        </div>
      </div>
    </div>

    <h2 class="mt-10 text-3xl md:text-6xl py-10">Robustness Learnt from Offline Data</h2>
    <div class="columns is-centered">
      <div class="column is-full-width is-centered has-text-centered">
        <video autoplay loop muted playsinline src="./static/videos/bare_floor.mp4" poster="./static/videos/loading-icon.gif" style="border: 1px solid #bbb; border-radius: 10px; margin: 1.0%;"></video>
      </div>
      <div class="column is-full-width is-centered has-text-centered">
        <video autoplay loop muted playsinline src="./static/videos/grass.mp4" poster="./static/videos/loading-icon.gif" style="border: 1px solid #bbb; border-radius: 10px; margin: 1.0%;"></video>
      </div>
      <div class="column is-full-width is-centered has-text-centered">
        <video autoplay loop muted playsinline src="./static/videos/halfhalf_1.mp4" poster="./static/videos/loading-icon.gif" style="border: 1px solid #bbb; border-radius: 10px; margin: 1.0%;"></video>
      </div>
    </div>
    
    <h2 class="mt-10 text-3xl md:text-6xl py-10">Compare with Baselines</h2>
    <div id="results-carousel" class="carousel results-carousel">
      <div class="item item-steve">
        <div class="column is-full-width is-centered has-text-centered">
          <video poster="./static/videos/loading-icon.gif" autoplay muted loop playsinline height="100%" src="./static/videos/uphill_backward_2.mp4"
          style="border-radius: 10px; margin-bottom: 15px; "></video>
          <video poster="./static/videos/loading-icon.gif" autoplay muted loop playsinline height="100%" src="./static/videos/downhill_backward_1.mp4"
          style="border-radius: 10px;"></video>
        </div>
      </div>
      <div class="item item-steve">
        <div class="column is-full-width is-centered has-text-centered">
          <video poster="./static/videos/loading-icon.gif" autoplay muted loop playsinline height="100%" src="./static/videos/uphill_forward.mp4"
          style="border-radius: 10px; margin-bottom: 15px; "></video>
          <video poster="./static/videos/loading-icon.gif" autoplay muted loop playsinline height="100%" src="./static/videos/downhill_forward.mp4"
          style="border-radius: 10px;"></video>
        </div>
      </div>
      <div class="item item-blueshirt">
        <div class="column is-full-width is-centered has-text-centered">
          <video poster="./static/videos/loading-icon.gif" autoplay muted loop playsinline height="100%" src="./static/videos/uphill_backward_1.mp4"
          style="border-radius: 10px; margin-bottom: 15px; "></video>
          <video poster="./static/videos/loading-icon.gif" autoplay muted loop playsinline height="100%" src="./static/videos/downhill_backward_2.mp4"
          style="border-radius: 10px;"></video>
        </div>
      </div>
    </div>


    <h2 class="mt-10 text-3xl md:text-6xl py-10">Ablation Studies</h2>
    <div id="results-carousel" class="carousel results-carousel">
      <div class="item item-steve">
          <video poster="./static/videos/loading-icon.gif" autoplay muted loop playsinline height="100%" src="./static/videos/failure_1.mp4"></video>
      </div>
      <div class="item item-steve">
        <video poster="./static/videos/loading-icon.gif" autoplay muted loop playsinline height="100%" src="./static/videos/failure_2.mp4"></video>
      </div>
      <div class="item item-blueshirt">
        <video poster="./static/videos/loading-icon.gif" autoplay muted loop playsinline height="100%" src="./static/videos/failure_3.mp4"></video>
      </div>
    </div>
    
    <h2 class="mt-10 text-3xl md:text-6xl py-10">Acknowledgement</h2>
    <div class="md:text-xl">
      This work was supported in part by NSF 2303735 for POSE, 
      in part byNSF 2238346 for CAREER, in part by The AI
      Institute and in part byInnoHK of the Government of the Hong
      Kong Special AdministrativeRegion via the Hong Kong Centre
      for Logistics Robotics.
    </div>

    <h2 class="mt-10 text-3xl md:text-6xl py-10">Citation</h2>
    <pre><code>@misc{huang2024diffuseloco,
  title={DiffuseLoco: Real-Time Legged Locomotion Control with Diffusion from Offline Datasets},
  author={Xiaoyu Huang and Yufeng Chi and Ruofeng Wang and Zhongyu Li and Xue Bin Peng and Sophia Shao and Borivoje Nikolic and Koushil Sreenath},
  year={2024},
  eprint={2404.19264},
  archivePrefix={arXiv},
  primaryClass={cs.RO},
  url={https://arxiv.org/abs/2404.19264},
}</code></pre>

</body>
</html>
