<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <!-- <meta http-equiv="refresh" content="2"> -->
  <link rel="icon" href="assets/favicon.ico" type="image/x-icon">
  <meta name="description" content="DiffuseLoco: Real-Time Legged Locomotion Control with Diffusion from Offline Datasets">
  <meta name="keywords" content="Robotics, Diffusion Policy, Transformer, Reinforcement Learning, Imitation Learning">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DiffuseLoco: Real-Time Legged Locomotion Control with Diffusion from Offline Datasets</title>
  <script src="https://cdn.tailwindcss.com"></script>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/go.min.js"></script>
  <script>hljs.highlightAll();</script>
</head>

<body>
  <div class="bg-gray-100 h-8 md:h-16"></div>

  <div class="container mx-auto px-10">
    <div class="mt-8 md:mt-20 w-full">
      <h1 class="text-2xl md:text-5xl text-left w-full">DiffuseLoco: Real-Time Legged Locomotion Control with Diffusion from Offline Datasets</h1>
      <p class="md:text-2xl mt-8">
        <a class="text-blue-500" href="https://scholar.google.com/citations?user=G-x_szsAAAAJ&hl=en">Xiaoyu Huang</a>,
        <a class="text-blue-500" href="https://chiyufeng.me/">Yufeng Chi</a>,
        <a class="text-blue-500" href="https://www.linkedin.com/in/edison-wang-1097a11ab/">Ruofeng Wang</a>,
        <a class="text-blue-500" href="https://zyliatzju.github.io/">Zhongyu Li</a>,
        <a class="text-blue-500" href="https://xbpeng.github.io/">Xue Bin Peng</a>,
        <a class="text-blue-500" href="https://people.eecs.berkeley.edu/~ysshao/">Sophia Shao</a>,
        <a class="text-blue-500" href="https://www2.eecs.berkeley.edu/Faculty/Homepages/nikolic.html">Borivoje Nikolic</a>,
        <a class="text-blue-500" href="https://hybrid-robotics.berkeley.edu/koushil/">Koushil Sreenath</a>
      </p>
    </div>
    <div class="md:text-2xl mt-6">CoRL 2024</div>
    
    <div class="flex flex-row flex-wrap justify-center my-8">
      <a class="flex-initial border rounded-full border-black px-2 py-1 m-1 md:m-10 hover:bg-gray-200" href="./static/paper/diffuseloco.pdf">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="inline size-4 mr-2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z" />
        </svg>
        Paper
      </a>
      <a class="flex-initial border rounded-full border-black px-2 py-1 m-1 md:m-10 hover:bg-gray-200" href="https://arxiv.org/abs/2404.19264">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="inline size-4 mr-2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M11.35 3.836c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 0 0 .75-.75 2.25 2.25 0 0 0-.1-.664m-5.8 0A2.251 2.251 0 0 1 13.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V8.25m8.9-4.414c.376.023.75.05 1.124.08 1.131.094 1.976 1.057 1.976 2.192V16.5A2.25 2.25 0 0 1 18 18.75h-2.25m-7.5-10.5H4.875c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V18.75m-7.5-10.5h6.375c.621 0 1.125.504 1.125 1.125v9.375m-8.25-3 1.5 1.5 3-3.75" />
        </svg>
        arXiv
      </a>
      <a class="flex-initial border rounded-full border-black px-2 py-1 m-1 md:m-10 hover:bg-gray-200" href="https://www.youtube.com/watch?v=JAWPT5oWID4">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="inline size-4 mr-2">
          <path stroke-linecap="round" stroke-linejoin="round" d="m15.75 10.5 4.72-4.72a.75.75 0 0 1 1.28.53v11.38a.75.75 0 0 1-1.28.53l-4.72-4.72M4.5 18.75h9a2.25 2.25 0 0 0 2.25-2.25v-9a2.25 2.25 0 0 0-2.25-2.25h-9A2.25 2.25 0 0 0 2.25 7.5v9a2.25 2.25 0 0 0 2.25 2.25Z" />
        </svg>
        Video
      </a>
      <a class="flex-initial border rounded-full border-black px-2 py-1 m-1 md:m-10 hover:bg-gray-200" href="https://github.com/HybridRobotics/DiffuseLoco">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="inline size-4 mr-2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M17.25 6.75 22.5 12l-5.25 5.25m-10.5 0L1.5 12l5.25-5.25m7.5-3-4.5 16.5" />
        </svg>
        Code
      </a>
    </div>

    <iframe class="w-full aspect-video" src="https://www.youtube.com/embed/JAWPT5oWID4?si=FpP4C6uyUrG8tW-6&start=2&autoplay=1&mute=1" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen autoplay></iframe>

    <h2 class="mt-10 text-xl md:text-5xl py-3 md:py-10">Abstract</h2>
    <div class="content has-text-justified">
      <p class="md:text-lg font-light">
        This work introduces <strong>DiffuseLoco</strong>, a framework for training multi-skill diffusion-based policies for dynamic legged locomotion from offline datasets, 
        enabling real-time control of diverse skills on robots in the real world. Offline learning at scale has led to breakthroughs in computer vision, 
        natural language processing, and robotic manipulation domains. However, scaling up learning for legged robot locomotion, especially with multiple 
        skills in a single policy, presents significant challenges for prior online reinforcement learning methods. To address this challenge, 
        we propose a novel, scalable framework that leverages diffusion models to directly learn from offline multimodal datasets with a diverse set of locomotion skills. 
        With design choices tailored for real-time control in dynamical systems, including receding horizon control and delayed inputs, 
        DiffuseLoco is capable of reproducing multimodality in performing various locomotion skills, zero-shot transfer to real quadrupedal robots, 
        and it can be deployed on edge computing devices. Furthermore, DiffuseLoco demonstrates free transitions between skills and robustness against environmental variations. 
        Through extensive benchmarking in real-world experiments, DiffuseLoco exhibits better stability and velocity tracking performance compared to prior reinforcement learning and non-diffusion-based behavior cloning baselines. 
        The design choices are validated via comprehensive ablation studies. This work opens new possibilities for scaling up learning-based legged locomotion controllers through the scaling of large, 
        expressive models and diverse offline datasets.
      </p>
    </div>
  
    <h2 class="mt-10 text-xl md:text-5xl py-3 md:py-10">Overview</h2>
    <img class="w-full md:w-2/3 mx-auto" src="workflow-diagram.png"/>

    <h2 class="mt-10 text-xl md:text-5xl py-3 md:py-10">Multi-modal Locomotion Trained Entirely Offline</h2>
    <div class="flex flex-none flex-wrap">
      <div class="basis-full md:basis-1/5 p-2">
        <video autoplay loop muted playsinline src="./static/videos/bump_1.mp4" poster="./static/loading.gif"></video>
      </div>
      <div class="basis-full md:basis-1/5 p-2">
        <video autoplay loop muted playsinline src="./static/videos/jump_1.mp4" poster="./static/loading.gif"></video>
      </div>
      <div class="basis-full md:basis-1/5 p-2">
        <video autoplay loop muted playsinline src="./static/videos/pace_1.mp4" poster="./static/loading.gif"></video>
      </div>
      <div class="basis-full md:basis-1/5 p-2">
        <video autoplay loop muted playsinline src="./static/videos/stand_1.mp4" poster="./static/loading.gif"></video>
      </div>
      <div class="basis-full md:basis-1/5 p-2">
        <video autoplay loop muted playsinline src="./static/videos/trot_1.mp4" poster="./static/loading.gif"></video>
      </div>
    </div>

    <h2 class="mt-10 text-xl md:text-5xl py-3 md:py-10">Smooth Transitioning</h2>
    <div class="flex flex-none flex-wrap">
      <div class="basis-full md:basis-1/2 p-2">
        <video autoplay muted loop playsinline src="./static/videos/skills_2_1.mp4" poster="./static/loading.gif"></video>
      </div>
      <div class="basis-full md:basis-1/2 p-2">
        <video autoplay muted loop playsinline src="./static/videos/skills_3_1.mp4" poster="./static/loading.gif"></video>
      </div>
    </div>

    <h2 class="mt-10 text-xl md:text-5xl py-3 md:py-10">Robustness Learnt from Offline Data</h2>
    <div class="flex flex-none flex-wrap">
      <div class="basis-full md:basis-1/2 p-2">
        <video autoplay loop muted playsinline src="./static/videos/grass.mp4" poster="./static/loading.gif"></video>
      </div>
      <div class="basis-full md:basis-1/2 p-2">
        <video autoplay loop muted playsinline src="./static/videos/board_and_matt.mp4" poster="./static/loading.gif"></video>
      </div>
      <div class="basis-full md:basis-1/2 p-2">
        <video autoplay loop muted playsinline src="./static/videos/woodenboard.mp4" poster="./static/loading.gif"></video>
      </div>
      <div class="basis-full md:basis-1/2 p-2">
        <video autoplay loop muted playsinline src="./static/videos/floor.mp4" poster="./static/loading.gif"></video>
      </div>
    </div>
    
    <h2 class="mt-10 text-xl md:text-5xl py-3 md:py-10">Compare with Baselines</h2>
    <div class="flex flex-none flex-wrap overflow-x-auto">
      <table class="table-auto w-full text-center leading-relaxed md:text-lg md:leading-loose">
        <thead>
          <tr>
            <th class="border-t-4 border-b-4 min-w-36">Goal (Task)</th>
            <th class="border-t-4 border-b-4 min-w-36">Metric</th>
            <th class="border-t-4 border-b-4 min-w-36" title="Adversarial Motion Prior">AMP</th>
            <th class="border-t-4 border-b-4 min-w-36" title="AMP with History Input">AMP w/ H</th>
            <th class="border-t-4 border-b-4 min-w-36" title="Transformer">TF</th>
            <th class="border-t-4 border-b-4 min-w-36" title="Transformer with Receding Horizon Control">TF w/ RHC</th>
            <th class="border-t-4 border-b-4 min-w-36">DiffuseLoco (Ours)</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <th>0.3m/s Forward</th>
            <td>Stability (%)</td>
            <td><b>100</b></td>
            <td><b>100</b></td>
            <td>80</td>
            <td><b>100</b></td>
            <td><b>100</b></td>
          </tr>
          <tr>
            <th class="border-b-4"></th>
            <td class="border-b-4">E<sub>v</sub></td>
            <td class="border-b-4">90.44 ± 1.87</td>
            <td class="border-b-4">90.63 ± 4.79</td>
            <td class="border-b-4">75.75 ± 6.07</td>
            <td class="border-b-4">39.28 ± 2.34</td>
            <td class="border-b-4"><b>33.22 ± 12.48</b></td>
          </tr>
          <tr>
            <th>0.5m/s Forward</th>
            <td>Stability (%)</td>
            <td><b>100</b></td>
            <td><b>100</b></td>
            <td><b>100</b></td>
            <td><b>100</b></td>
            <td><b>100</b></td>
          </tr>
          <tr>
            <th class="border-b-4"></th>
            <td class="border-b-4">E<sub>v</sub></td>
            <td class="border-b-4">50.44 ± 1.97</td>
            <td class="border-b-4">46.29 ± 2.55</td>
            <td class="border-b-4">54.35 ± 2.66</td>
            <td class="border-b-4">37.46 ± 5.31</td>
            <td class="border-b-4"><b>12.91 ± 6.84</b></td>
          </tr>
          <tr>
            <th>0.7m/s Forward</th>
            <td>Stability (%)</td>
            <td>0</td>
            <td>20</td>
            <td>0</td>
            <td>40</td>
            <td><b>100</b></td>
          </tr>
          <tr>
            <th class="border-b-4"></th>
            <td class="border-b-4">E<sub>v</sub></td>
            <td class="border-b-4"><s>fail 5/5</s></td>
            <td class="border-b-4">54.96 ± 0.00</td>
            <td class="border-b-4"><s>fail 5/5</s></td>
            <td class="border-b-4">39.36 ± 5.02</td>
            <td class="border-b-4"><b>24.80 ± 8.91</b></td>
          </tr>
          <tr>
            <th>Turn Left</th>
            <td>Stability (%)</td>
            <td>20</td>
            <td><b>100</b></td>
            <td>0</td>
            <td><b>100</b></td>
            <td><b>100</b></td>
          </tr>
          <tr>
            <th class="border-b-4"></th>
            <td class="border-b-4">E<sub>v</sub></td>
            <td class="border-b-4">20.96 ± 0.00</td>
            <td class="border-b-4">33.39 ± 6.96</td>
            <td class="border-b-4"><s>fail 5/5</s></td>
            <td class="border-b-4">13.41 ± 5.02</td>
            <td class="border-b-4"><b>12.79 ± 5.64</b></td>
          </tr>
          <tr>
            <th>Turn Right</th>
            <td>Stability (%)</td>
            <td><b>100</b></td>
            <td><b>100</b></td>
            <td><b>100</b></td>
            <td>80</td>
            <td><b>100</b></td>
          </tr>
          <tr>
            <th class="border-b-4"></th>
            <td class="border-b-4">E<sub>v</sub></td>
            <td class="border-b-4">18.61 ± 2.40</td>
            <td class="border-b-4">33.39 ± 6.96</td>
            <td class="border-b-4">25.86 ± 1.47</td>
            <td class="border-b-4">8.69 ± 5.04</td>
            <td class="border-b-4"><b>2.22 ± 1.03</b></td>
          </tr>
        </tbody>
      </table>
    </div>


    <h2 class="mt-10 text-xl md:text-5xl py-3 md:py-10">Ablation Studies</h2>
    <div class="flex flex-none flex-wrap">
      <div class="basis-full md:basis-1/3 p-2">
        <video autoplay muted loop playsinline src="./static/videos/failure_1.mp4"></video>
      </div>
      <div class="basis-full md:basis-1/3 p-2">
        <video autoplay muted loop playsinline src="./static/videos/failure_2.mp4"></video>
      </div>
      <div class="basis-full md:basis-1/3 p-2">
        <video autoplay muted loop playsinline src="./static/videos/failure_3.mp4"></video>
      </div>
    </div>
    
    <h2 class="mt-10 text-xl md:text-5xl py-3 md:py-10">Acknowledgement</h2>
    <div class="md:text-xl">
      This work was supported in part by NSF 2303735 for POSE, in part by NSF 2238346 for CAREER, in part by The AI Institute and in part by InnoHK of the Government of the Hong Kong Special Administrative Region via the Hong Kong Centre for Logistics Robotics.
    </div>

    <h2 class="mt-10 text-xl md:text-5xl py-3 md:py-10">Citation</h2>
    <pre>
      <code>@misc{huang2024diffuseloco,
  title={DiffuseLoco: Real-Time Legged Locomotion Control with Diffusion from Offline Datasets},
  author={Xiaoyu Huang and Yufeng Chi and Ruofeng Wang and Zhongyu Li and Xue Bin Peng and Sophia Shao and Borivoje Nikolic and Koushil Sreenath},
  year={2024},
  eprint={2404.19264},
  archivePrefix={arXiv},
  primaryClass={cs.RO},
  url={https://arxiv.org/abs/2404.19264},
}</code>
    </pre>

  </div>

  <div class="h-8 md:h-16"></div>
  <div class="bg-gray-100 h-8 md:h-16"></div>

</body>
</html>
